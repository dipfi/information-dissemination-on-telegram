---
title: "Information Dissemination within the Corona Sceptic Network on Telegram"
author: "Damian Durrer"
date: "`r format(Sys.time(), '%d. %B %Y')`"
output:
  pdf_document:
    toc: yes
    toc_depth: '2'
    number_sections: yes
  html_document:
    toc: yes
    toc_depth: '2'
    df_print: paged
bibliography: bibliography.bib
---

```{r message = FALSE, warning = FALSE, echo = FALSE, include = FALSE, eval = TRUE, message = FALSE, tidy = TRUE}
knitr::opts_chunk$set(echo = TRUE)

set.seed(123)
```

```{r libraries, eval = TRUE, include = FALSE, echo = FALSE, message = FALSE, warning = FALSE, tidy = TRUE}
# Load required libraries
library(data.table)
library(ggplot2)
theme_set(theme_minimal(base_size = 9))
library(dplyr)
library(lubridate)
library(tidygraph)
library(ggraph)
library(igraph)
library(stringr)
library(tinytex)
library(formatR)
library(knitr)
```

```{r utils, eval = TRUE, include = FALSE, echo = FALSE, message = FALSE, warning = FALSE, tidy = TRUE}
# Load functions to:
# - Read and prepare the data from the json files
# - extract the links from the messages
# - conduct a permutation test on whether links from alternative media were forwarded more often than links from traditional media

source("utils/functions.R")

```

  
  
# Abstract

This report is an analysis of the origin and dissemination of information posted in and forwarded to four corona skeptic groups on Telegram. The analysis follows the literature on chambers on social media and uses publicly available data from Telegram.  The hypothesis to be tested is, that links from alternative media are more likely to be forwarded to corona skeptic groups than links from traditional media. The results suggest that there is no evidence for this hypothesis.



# Motivation

The global COVID-19 pandemic has ravaged the world from early 2020 until the publication of this study in April 2021. As per 8 April 2021, the number of deaths in Switzerland, Austria and Germany from the pandemic is around 100'000, according to the platform "Our World in Data". This death-toll occurred in spite of severe restrictions to public life in order to curb the further spread of the virus in all three countries [@OurWorldinData.482021]. Since early in the pandemic, the term "corona-skeptics" has been widely used in the media for individuals and communities claiming that the health impact of the pandemic is overstated by governments and media. Corona skeptics are of the opinion, that the damages caused and costs incurred by the counter-measures, such as lock-downs, testing and immunizations, outweigh their benefits. They are generally skeptical of traditional media reports, which they believe to be focusing too much on the adverse effects of the pandemic and not scrutinizing enough the damage caused by the respective counter-measures. As an example, the first message posted in the Telegram group "Corona Virus Informationen Diskussion", one of the later analyzed groups, reads as follows:

"Hallo an alle lieben Menschen! Diese Gruppe dient zur Information rund um das Coronavirus! Diese Gruppe soll gegen die Panikmache der Medien und die große Desinfomraton helfen! Lasst Euch nicht von den Medien und Pharmakonzernen in Panik versetzen! Der Cornavirus ist bei weitem nicht so gefährlich, wie uns gesagt wird!"

It has to be noted that to the knowledge of the authors of this report, there has not been an attempt by academia to properly define the term. Thus the loose definition above is a suggestion of the authors and and should be refined for further studies.

As early as May 2020, the Newspaper "Süddeutsche Zeitung" has released a report, revealing the importance of the platform Telegram for the corona virus skeptic communities (@Bruhl.21052020). As @Rogers.2020 shows, the "deplatforming" of extreme and anti-establishment actors from other popular platforms has increasingly led to a migration of such individuals to Telegram. This raises the question, what information reaches these corona skeptic groups. The comprehensive literature on echo chambers in social media suggests, that the mechanisms of social media increase the risk, that users are only confronted with contents they agree with while other opinions do not reach them [@Garimella.2018].

As there is a big distrust among the corona skeptic communities with in traditional media and government agencies (commonly called traditional media from here on), the existence of an echo chamber could suggest that information posted on Telegram from such traditional media is less likely to be forwarded in corona skeptic groups than contents from alternative sources.

The questions addressed in the report are whether information from alternative media are more likely to reach the corona skeptic communities on Telegram than information from traditional media sources. Further, it is alanyzed whether information from alternative media is more likely to be forwarded among these communities in these communities than information from traditional media. This would suggest, that campaigns aimed at increasing awareness on the impact of the pandemic are less effective if the content is posted from traditional sources, as they are less likely to be further spreas in the network. With that, this and further analysis could provide valuable insights for the organizaing of such campaigns in the future.



# Project Plan


## Changes from the intitial project plan

The original idea of this project was to analyze the links posted in various corona skeptic groups on Telegram. The plan was to see how likely links from domains connected to right-wing politics and conspiracy theories are posted in the corona skeptic groups and how likely they are to be forwarded from one group to another.

Over the course of the project, there have been two major adjustments:

1. The focus was extended from domains connected to right-wing politics and conspiracy theories to domains from alternative media sources in general, including blogs, self-declared alternative media and sources commonly associated with any of the extreme ends of the political spectrum.
2. Due to the workings of Telegram, messages cannot be forwarded from one group to another, but only form channels to groups or channels to channels (more on Telegram below). Thus, instead of looking at how links were forwarded between groups, the analysis focuses on forwards from channels to groups. An introduction of the workings of welegram and the difference between groups and channels can be found in the appendix.


## Project Outline

During this project, the following main tasks have been completed:

1. Identify four corona skeptic groups on Telegram and download the complete chat history
2. Identify channels from where the most links were forwarded to these groups and download the complete histories of these channels
3. Extract the links posted in these channels and the domains associated with it
4. Assign the most commonly posted domains to categories and select those connected to alternative and traditional media sources
5. Explore the data and assess whether the information reaching these groups is more likely to originate from alternative media sources than from traditional media sources
6. Test the hypothesis that links associated with alternative media posted in these channels are more likely to be forwarded to the four groups than those associated with traditional media


## Scope

The analysis focuses on a one year timespan from 25.2.2020 to 25.2.2021. The analyzed groups are all in German, thus the analysis is restricted to the DACH region. The selected groups are:

- "Corona Infos und Fakten": 216 Members 
- "Corona Rebellen": 4'714 Members
- "Corona Rebellen Chat": 1'829 Members (Discussion Room of the "Corona Rebellen Schweiz" Channel)
- "Corona Virus Informationen Diskussion": 2'598 Members (Discussion Room of the "Corona Virus Informationen" Channel)
(Member numebr as per 24/03/2021)

Proper definitions of terms such as "corona sceptic communities" and categories like "alternative media" and "traditional  media" as well an reproducible process for assigning the domains to any of the latter two categories are all out of scope of this report. Is is strongly suggested that any further analysis takes on these tasks.


## Reproducibility

All data and code used for this report is publically available on github [@GitHub.482021].

# Data retrieval

All data analyzed for this report is publicly available through the export function on Telegram. Any public group and channel histories can be downloaded as JSON files. The relevant data for this report are made available in the following github repository [LINK github].



# Data processing

First, the complete chat history of the four groups in scope of this analysis is exported from Telegram. The data is pre-precessed, the links are extracted from the messages and reduced to the domains (e.g. "https://github.com/dipfi/corona-skeptic-information-on-Telegram", would be reduced to "github.com").
```{r prepare_groups, eval = FALSE, include = FALSE, echo = TRUE, message = FALSE, warning = FALSE, tidy = TRUE}

# read all Telegram messages
read_Telegram_messages(in_path = "input/groups/", ignore = c("old","small"), out_path = "output/groups/")

# select relevant features and prepare data
prepare_Telegram_messages(in_file = "output/groups/all_messages.rds", out_path = "output/groups/")

# THIS TAKES AROUNG 10MIN TO RUN (DEPENDING ON MACHINE)

# extract links from messages
extract_links(in_file = "output/groups/all_messages_prepared.rds", out_path = "output/groups/", domains_file = "utils/top-level-domain-names.csv")

```

```{r read_groups, eval = TRUE, include = FALSE, echo = FALSE, message = TRUE, warning = TRUE, tidy = TRUE}
# Load messages and links from for the groups of interest

 #Read links links from messages between 25/2/2020 - 25/2/2021
msg_groups <- setDT(readRDS("output/groups/all_messages_prepared.rds")[date %between% c("2020-02-25", "2021-02-25")])[action == "message"]
links_groups <- setDT(readRDS("output/groups/links.rds")[date %between% c("2020-02-25", "2021-02-25")])
```


The channels most important for these groups were identified according to the following criteria:
- count forwarded links by origin (channels) for each of the groups 
- restrict to channels with at least 50 forwards in at least one of the groups, such that calculating a meaningful forward-ratio is possible
- restrict to channels which are among the 10 most important channels for at least one of the four groups. This ensures that channels are not only selected by their importance for the largest group.
```{r important_channels, eval = TRUE, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE, tidy = TRUE}

# count occurrences by group and origin. Restrict on origins with 50 or more occurrences per group
channels_occurrence <- setorder(links_groups[,.(occurrence = .N),
                            by = c("forwarded_from", "channel")][occurrence >= 50, c("forwarded_from","channel", "occurrence")],
                            -channel, -occurrence)

# restrict to channels which are in the top 10 for any of the groups
important_channels <- c()
for(i in unique(channels_occurrence$channel)){
  important_channel_by_group <- na.omit(channels_occurrence[channel == i &
                                            !is.na(forwarded_from), "forwarded_from"][1:10])
  important_channels <- unique(rbind(important_channels, important_channel_by_group))
}

# write important channels file to disk
write.csv(important_channels, "output/channels/important_channels.csv")

```


This leaves to a sample of 28 channels. The histories of 24 of them were available for exporting and were subsequently retrieved from Telegram. Again, the messages are pre-processend and links are extracted from the messages and reduced to the domains. 

```{r prepare_channels, eval = FALSE, include = FALSE, echo = FALSE, message = FALSE, warning = FALSE, tidy = TRUE}
#read all Telegram messages
read_Telegram_messages(in_path = "input/channels/", ignore = c("other"), out_path = "output/channels/")

#select relevant features and prepare data
prepare_Telegram_messages(in_file = "output/channels/all_messages.rds", out_path = "output/channels/")

#THIS TAKES AROUNG 10MIN TO RUN (DEPENDING ON MACHINE)
#extract links from messages
extract_links(in_file = "output/channels/all_messages_prepared.rds", out_path = "output/channels/", domains_file = "utils/top-level-domain-names.csv")
```

```{r read_channels, eval = TRUE, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE, tidy = TRUE}

# Read msg from messages between 25/2/2020 - 25/2/2021
msg_channels <- setDT(
  readRDS("output/channels/all_messages_prepared.rds")[date %between% c("2020-02-25", "2021-02-25")]
  )[action == "message",]
msg_groups <- setDT(
  readRDS("output/groups/all_messages_prepared.rds")[ date %between% c("2020-02-25", "2021-02-25")]
  )[action == "message",]
msg_all <- rbind(msg_channels, msg_groups)
 
# Read links from messages between 25/2/2020 - 25/2/2021
links_channels <- setDT( readRDS("output/channels/links.rds")[date %between% c("2020-02-25", "2021-02-25")])
# links_groups <- setDT(readRDS("output/groups/links.rds")[# date %between% c("2020-02-25", "2021-02-25")])

links_all <- rbind(links_channels, links_groups)

msg_channels$channel_type <- ifelse(msg_channels$channel_type %like% "channel",
                                    "channel", "group")
msg_groups$channel_type <- ifelse(msg_groups$channel_type %like% "channel",
                                  "channel", "group")
msg_all$channel_type <- ifelse(msg_all$channel_type %like% "channel",
                               "channel", "group")

links_channels$channel_type <- ifelse(links_channels$channel_type %like% "channel",
                                      "channel", "group")
links_groups$channel_type <- ifelse(links_groups$channel_type %like% "channel",
                                    "channel", "group")
links_all$channel_type <- ifelse(links_all$channel_type %like% "channel",
                                 "channel", "group")
```

Next, the domains which were most often posted in the 24 channels were identified according to the following logic:
- First, the the set of domains was restricted to the domains which were posted at least 50 times in at least one of the channels. This is to ensure that calculating the forward-ratio at a later stage is meaningful.
- Next, all the domains which do not belong to the 10 most posted domains in any of the channels were removed. This avoids an over-representation of channels whcih post a large amount of links.

```{r important_media, eval = TRUE, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE, tidy = TRUE}

# Read links links from messages between 25/2/2020 - 25/2/2021
# links_channels <- setDT(readRDS("output/channels/links.rds")[
#                     date %between% c("2020-02-25", "2021-02-25")])
# links_groups <- setDT(readRDS("output/groups/links.rds")[
#                       date %between% c("2020-02-25", "2021-02-25")])

all_channels <- unique(links_all$channel)

#count occurrences by domain and restrict to links with at least 50 occurrences in all of the channels combined
links_occurrence_channels <- setorder(links_channels[,.(occurrence = .N),
                                      by = c("link_short")][occurrence >= 50, c("link_short", "occurrence")],
                                      -occurrence)
links_groups_from_channels <- links_groups[forwarded_from %in% all_channels,]
links_occurrence_groups_from_channels <- setorder(links_groups_from_channels[,.(occurrence = .N),
                                      by = c("link_short")][, c("link_short", "occurrence")], -occurrence)


links_occurrence_channels_bychan <- setorder(links_channels[,.(occurrence = .N),
                                      by = c("link_short", "channel")][, c("link_short", "channel", "occurrence")],
                                      -channel, -occurrence)

links_occurrence_channels_bychan <- links_occurrence_channels_bychan[link_short %in% links_occurrence_channels$link_short,]

#exclude links which are not
important_media_channels <- c()
for(i in unique(links_occurrence_channels_bychan$channel)){
  important_media_by_group <- na.omit(links_occurrence_channels_bychan[channel == i &
                                          !is.na(link_short), "link_short"][1:10])
  important_media_channels <- unique(rbind(important_media_channels,
                                           important_media_by_group))
}


#extract domains with more than 100 appearances in any of the groups 
important_media_channels <- important_media_channels$link_short

#write important media file to disk
write.csv(important_media_channels, "output/channels/important_media.csv")

```

```{r restrict_data, eval = TRUE, include = FALSE, echo = FALSE, message = FALSE, warning = FALSE, tidy = TRUE}

# read file with domains assigned to category
media <- setDT(read.csv("utils/important_media_assigned.csv"))[link_short %in% important_media_channels,]

# check if all important domains (at least 100 occurrences) are assigned to a category
#all(important_media_channels %in% media$link_short)

# restrict links to domains connected to alternative or
# traditional media occurring at least 100x
links_cat <- merge(media[category %in% c("alternative_media","traditional_media"),],
                   links_groups, by = "link_short")

links_cat$forwarded <- !is.na(links_cat[,.(forwarded_from)])

#restrict links to domains connected to alternative or traditional media occurring at least 50x in all channels and are in the 10 most posted links in any onle of the channels
links_cat_channels <- merge(media[category %in% c("alternative_media","traditional_media"),],
                            links_channels, by = "link_short")
links_cat_groups_from_channels <- merge(media[category %in% c("alternative_media","traditional_media"),],
                                        links_groups_from_channels, by = "link_short")[forwarded_from %in% all_channels,]
links_cat_all <- rbind(links_cat_channels, links_cat_groups_from_channels)
```


This left a sample of 81 domains, which were assigned to the one of the following categories:

- Platforms: e.g. youtube, vimeo, telegra.ph, instagram, Twitter, etc
- Alternative media: Domains connected to blogs, opinion-magazines or media outlets which are self-declaring to be an "alternative to traditional/mainstream media" or are commonly regarded as such. This includes media from both extremes of the political spectrum, religious sects, conspiracy theorists and propaganda of foreign countries (e.g. Russia). This specifically also includes domains directly connected to the corona skeptic community.
- Traditional media: Domains connected to established news agencies, government agencies or scientific institutions.
- Other: other domains like link-shorteners, archives, event-websites, payment-portals, etc.

Accordint to the above definitions, 30 of the 81 domains are associated with alternative media sources, while 22 are associated with traditional media sources. For the further analysis, the data-set is restricted to links from any one of these 52 domains.

The assignment of these links were conducted by the authors without specific expertise or formal and reproducible process in place. For further work, it is suggested to formalize this process and work with experts in media or communication. The list of domains and the assigned categories can be found in the appendix.



# Analysis

The activity in the channels has picked up as soon as the pandemic started in spring 2020 and remained roughly stable over analyzed time-period. The activity in the groups has strongly increased with the second wave of the pandemic in fall 2021. Further details can be read from the plot in the appendix, section "Activity of the groups and channels over timE".

Some of the channels are extremely important for individual groups. There are for example more than 1000 forwards of such links from the channel "Corona Virus Informationen" for the groups "Corona Virus Informationen Diskussion". This is not surprising, as the group is the official discussion room of the channel in Question. Other channels, such as "Eva Hermann Offiziell" and "Ignaz Bearth" are not as important for individual groups, but have links forwarded to all of them. A network graph for the forward network can be found in the appendix in the section "Forward network from channels to groups".

Further, some users post links in multiple of the groups analyzed. Yet, the share of users contributing to multiple groups is small compared to the users contributing in individual channels. For more information, see appendix section "Exploratory analysis of groups".

The table below shows the number of times links associated to the 52 domains from alternative and traditional media sources were posted in any of the four groups. "Occurrences in groups" is the total number of times a link from one of the categories was posted (either directly or by forward). "Total forwards" is the subset of those links which got there through a forward from any Telegram channel (i.e. not only from the 24 channels sampled above). 
```{r occurance_group_table, eval = TRUE, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE, tidy = TRUE, results = 'asis'}
# add the ratio of forwarded links to original posts
links_cat_agg <- links_cat[,.(occurrences = .N, forwards = sum(forwarded)),
                           by=.(category, link_short)]

links_cat_agg_table <- links_cat[,.(occurrences_in_group = .N, total_forwarded = sum(forwarded)),
                           by=.(category)]

kable(links_cat_agg_table)
```

It can be seen that occurrence of the links is similar for both category, but that much more of the links from alternative media got there by being forwarded. On the other hand, more of the traditional media links were posted directly into the groups. In the section "Testing difference in the forward-ratio in groups" in the appendix, it is shown that an alternative media link posted in one of the groups is significantly more likely to have ended up there by being forwarded from some Telegram channel than their traditional media counterparts. Traditional media links, on the other hand, seem to be more likely to be posted directly to the groups (yet, this latter statement has not been tested).

The next table shows the number of occurrences of links in the 24 identified channels and number of times they were forwarded from one of these channels to any of the four groups. Again, the set of links is restricted domains associated with traditional or alternative media.
```{r occurance_channel_table, eval = TRUE, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE, tidy = TRUE, results = 'asis'}

links_cat_agg_channels <- links_cat_channels[,.(occurrences_in_channels = .N),
                           by=.(category)]

links_cat_agg_groups_from_channels <- links_cat_groups_from_channels[,.(forwarded_to_groups = .N),
                           by=.(category)]

links_cat_agg_all_table <- merge(links_cat_agg_channels, links_cat_agg_groups_from_channels, by = "category")

kable(links_cat_agg_all_table)

```

Notably, alternative media links were posted almost twice as much in the channels as traditional media links. For either category, roughly 10% of them were forwarded to any of the four groups.

For each of the domains in the sample, the forward-ratio is calculated as follows:

$$ forward\_ratio = \frac{forwards\_to\_groups}{occurrences\_in\_channels} $$

```{r forward_ratio, eval = TRUE, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE, tidy = TRUE}

# add the ratio of forwarded links to original posts
links_cat_channels_agg <- links_cat_channels[,.(occurrences = .N),
                                             by=.(category, link_short)]
links_cat_groups_from_channels_agg <- links_cat_groups_from_channels[, .(forwards = .N),
                                              by=.(category, link_short)]
links_cat_agg_new <- merge(links_cat_channels_agg, links_cat_groups_from_channels_agg,
                                              by = c("category", "link_short"))
links_cat_agg_new$ratio_forwarded <- links_cat_agg_new$forwards/links_cat_agg_new$occurrences

```

The following plot shows the distribution of forward-ratios by domain for each category.
```{r forward_ratio_plot, eval = TRUE, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE, tidy = TRUE, fig.align = "center", fig.asp = 0.5, out.width="100%"}

# plot the distribution of the forward-ratios for alternative and traditional media links and add the means

mu <- links_cat_agg_new[, .(mu=mean(ratio_forwarded)), by = category]
p <- links_cat_agg_new %>% 
  ggplot(aes(x=ratio_forwarded, color = category)) +
  geom_density() +
  geom_vline(data=mu, aes(xintercept=mu, color=category), linetype="dashed") +
  labs(title = "Distribution of the mean forward-ratio by link-category")
p

```
The mean forward-ratio is almost identical for the two categories.

With this set-up, the actual hypothesis stated at the beginning of the report can now be tested:

Hypothesis: If a link is posted in any of the 24 channels, it is more likely to be forwarded to one of the four groups if it is associated with an alternative media domain than if it is associated with a traditional media domain.

With a permutation test, the above hypothesis is tested against the Null that links from alternative media domains are less or equally likely to be forwarded to one of the groups. The conducted test is thus one-sided.

```{r permutation_plot, eval = TRUE, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE, tidy = TRUE, fig.align = "center", fig.asp = 0.5, out.width="100%"}
permutation_test <- perm_test_links(links_cat_agg_new)

permutation_test_plot <- permutation_test[["plot"]]
permutation_test_plot
```


The p-value of the permutation test is close to 0.5. The Null hypothesis is not rejected. There is no evidence from the data that links from alternative media domains are more likely to be forwarded to the four analyzed groups than links from traditional media domains.



# Conclusion

This report suggests that alternative media links are about equally likely to be posted to one of the four corona skeptic groups in the scope of this analysis. Further, there is no evidence that a traditional media link posted in a Telegram channel is less likely to be forwarded to one of the groups than an alternative media link. Thus, here is no immediate indication that contents published in traditional media is less relevant for opinion formation in the corona skeptic groups on Telegram than content published on alternative media websites.

Yet, exploratory analysis of the data has revealed some interesting insights:
- Alternative media links posted in the analyzed groups are more likely to have arrived there by being forwarded from another telegram channel
- In the channels which are most important for these groups, alternative media links are much more likely to be posted than traditional media links

A possible explanation for the former point is that publishers of alternative media content are themselves often active on Telegram, as suggested by @Rogers.2020. It is possible that they post links to their own blogs on their Telegram channels and forward them to Telegram groups. At the same time, other members of the groups might not otherwise be active on Telegram, as suggested by the "Exploratory analysis of groups" in the appendix. Thus, they are more exposed to traditional media and more likely to post links to such sources. This hypothesis could e.g. be tested by evaluating whether alternative media links are posted by a small group of very active users while traditional media links are more often posted by a large group of less active users

The latter point could be explained by the fact that many of these channels are directly associated with an alternative media website, such as e.g. a blog. This might explain the high prevalence of alternative media links in the channels.



# Critique

This analysis shows, that the publicly available data from Telegram lends itself to analysis of dynamics and information dissemination among specific social groups. It can be easily accessed. The code available on the github repository can be used as a template for reading and pre-processing the data, as well as to extract the links.

Yet, this project has been very limited in scope, by only looking at four groups, 24 channels and 52 domains. Further, the exclusive focus on the origin of the information only tells part of the story. It would be interesting to assess the sentiment of the discussions around the links from these different sources, as well as the contents of the articles behind.

As indicated before, concisely defining central terms like "corona skeptic" and working out a proper process for assessing domains to categories was not in scope of this project. This would have to be a central part of future research on this topic.

\newpage

# References

<div id="refs"></div>

\newpage

# Appendix


## Introduction to Telegram

Telegram is a commonly used messenger service [LINK Telegram]. Unlike services like WhatsApp or Signal, it also provides options for public groups and channels (described below). Due to the low level of moderation compared to other services like Twitter, it has recently been increasingly associated with extreme and anti-establishment contents [LINK Rogers].

On Telegram there are two distinct ways of communication: Channels and Groups. 

- Channels are a way for a single user or organization to share messages or links with his followers. Typically, only one user is posting in a channel, while many users are following it.

- Groups are chat-rooms, where users can interact with each other. Every member of the group has write-access. For some groups, every Telegram user has read-access. We are focusing exclusively on groups and channels with public read-access.

All data from public groups and channels can be exported as .json file through the export function provided in the app.

More information can be found in the Telegram FAQ [LINK Telegram FAQ]


## Activity of the groups and channels over time

The plot below shows the activity of of the groups and channels over time.
```{r activity_plot, eval = TRUE, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE, tidy = TRUE, fig.align = "center", fig.asp = 0.5, out.width="100%"}

activity_per_week <- msg_all[ , list(count = .N), by = list(date = floor_date(date,"week"), channel_type)][,abs:= count, by = list(channel_type)]

# rel_activity_per_week <- links[ , list(count = .N), by = list(date = floor_date(date,"week"), channel)][,rel:= round(count/sum(count), 2), by = list(channel)]

#plot by week and type
ggplot(setorder(activity_per_week, date)[1:(nrow(activity_per_week)-length(unique(activity_per_week$channel_type))),], aes(x=date,y=abs,col=channel_type)) +
  geom_line() +
  xlab("") +
  ylab("Messages per week") +
  ggtitle("Messages per week in groups and channels") +
  scale_x_datetime(date_breaks = "1 month", date_labels = "%b") +
  scale_color_discrete(name = "Type")

```


## Forward network from channels to groups

The graph below shows the channels from which the links are forwarded to the groups. The red nodes correspond to the channels in which the links were posted, while the blue nodes correspond to the groups to which they were forwarded. The size of the nodes is the total number of links from the categories alternative and traditional media posted to the respective channel and the total number of times they were forwarded from any channel to a group, respectively. The size of the edges corresponds to the number of times these domains were forwarded from one of the channels to one of the four groups.
```{r forward_plot, eval = TRUE, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE, tidy = TRUE, fig.align = "center", fig.asp = 0.7, out.width="100%"}

edges <- setDT(data.frame(from = links_cat_groups_from_channels$forwarded_from, to = links_cat_groups_from_channels$channel))
edges <- edges[!(is.na(edges$from)),]
edges <- edges[,.(forwards = .N), by = c("from", "to")]

chans <- links_cat_all[,.(count_links = sum(ifelse(forwarded_from %in% all_channels, 1, 0))), by = c("channel", "channel_type")]
chans$id <- 1:nrow(chans)

for(i in all_channels){
  edges$from[edges$from == i] <- chans$id[chans$channel == i]
}

for(i in all_channels){
  edges$to[edges$to == i] <- chans$id[chans$channel == i]
}

edges$from <- as.numeric(edges$from)
edges$to <- as.numeric(edges$to)

grps_graph <- tbl_graph(chans, edges, directed=F)

grps_graph %>% 
  ggraph(layout = "stress") +
  geom_edge_link(alpha = 0.25, aes(width = forwards)) +
  geom_node_point(aes(size = count_links, color = channel_type)) + 
  geom_node_text(aes(label = str_trunc(channel, 20)),  repel = TRUE, size = 3) +
  scale_edge_width(range = c(1, 8)) +
  labs(title = 'Forwards from channels to groups') -> grps_graph_plot

plot(grps_graph_plot)

```
A couple of points become obvious when looking at the above network graph:

1. Content from many channels is forwarded not only to one, but to multiple groups.
2. There are a few channels of specific interest:
a) The links posted in the channel "Corona Virus Informationen" is forwarded extremely often to the group "Corona Virus Informationen Diskussion". This is expected, as the group "Corona Virus Informationen Diskussion" is the official discussion thread of the channel in question
b) Some channels, like "Eva Hermann Offiziell" and "Ignaz Bearth" are a central source of information for multiple groups


## Exploratory analysis of groups

```{r activity_groups_plot, eval = TRUE, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE, tidy = TRUE, fig.align = "center", fig.align = "center", fig.asp = 0.5, out.width="100%"}

activity_per_week <- links_groups[ , list(count = .N), by = list(date = floor_date(date,"week"), channel)][,abs:= count, by = list(channel)]

#plot by week and type
ggplot(setorder(activity_per_week, date)[1:(nrow(activity_per_week)-length(unique(activity_per_week$channel))),], aes(x=date,y=abs,col=channel)) +
  geom_line() +
  xlab("") +
  ylab("Messages per week") +
  ggtitle("Messages per week and group") +
  scale_x_datetime(date_breaks = "1 month", date_labels = "%b") +
  scale_color_discrete(name = "Group")


```
The plot above shows that the activity over all groups has been increasing as the pandemic went on. Specifically, there has been a large increase in activity in Fall 2020. The group "Corona Infos und Fakten" only came into existence in December 2020 and activity is a lot lover than in the other groups. "Corona Virus Informationen und Diskussionen" is the most active group.

The variance in the number of messages posted between channels reflects that the size of the groups is very different, as can be seen in the overview given in the seciton "Project Plan".
```{r contributors_table, eval = TRUE, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE, tidy = TRUE, results = 'asis'}

#Check for users that are subscribed in multiple channels
user_per_channel_with_count <- msg_groups[, list(count_messages = .N), by = list(user, user_id, channel)]

user_per_channel_agg <- unique(msg_groups[,c("user_id", "channel")])[, .(count_contributors = .N), by = list(channel)]

kable(user_per_channel_agg)
```
Concretely, the group "Corona Infos und Fakten" has a lot less contributors, while "Corona Virus Informationen Diskussion" has a lot more. This is in line with the lower activity shown above.


The graph below shows the different groups by the number of contributors and and shared contributors. A contributor is here defined as a user which posted at least one alternative or traditional media link in the respective groups.
```{r contributors_plot, eval = TRUE, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE, tidy = TRUE, fig.align = "center", fig.asp = 0.7, out.width="100%"}

#Check for users that are subscribed in multiple channels
user_per_channel_with_count <- links_cat[category %in% c("alternative_media","traditional_media"), list(count_messages = .N), by = list(user, user_id, channel)]

user_per_channel_agg <- unique(links_cat[category %in% c("alternative_media","traditional_media"), c("user_id", "channel")])[, .(count_users = .N), by = list(channel)]

grps <- data.frame(name = unique(links_cat$channel),
                   id = 1:length(unique(links_cat$channel)))

grps$label <- c("Corona \n Infos \n und \n Fakten","Corona \n Rebellen","Corona \n Rebellen \n Chat","Corona \n Virus \n Informationen \n Diskussion")

edges <- setDT(as.data.frame(t(combn(grps$id, 2))))
names(edges) <- c("from", "to")

for(i in 1:nrow(edges)){
  x <- edges[i,]
  group1 <- user_per_channel_with_count[channel == grps$name[x$from],]
  group2 <- user_per_channel_with_count[channel == grps$name[x$to],]
  edges$common_contributors[i] <- sum(group1$user_id %in% group2$user_id)
}

edges <- edges[common_contributors > 0,]

grps_graph <- tbl_graph(grps, edges, directed=F)

number_of_contributors <- user_per_channel_agg$count_users

grps_graph %>% 
  ggraph(layout = "kk") +
  geom_edge_link(alpha = 0.25, aes(width = common_contributors)) +
  geom_node_point(color = "cyan", aes(size = number_of_contributors)) + 
  geom_node_text(aes(label = label),  repel = FALSE, size = 3) +
  scale_edge_width(range = c(1, 8)) + # control size
  scale_size(range = c(1, 10)) + ylim(-1.5,1.5)+xlim(-1.5,1.5) +
  #theme_graph() +
  labs(title = 'Network of groups by contributors') -> grps_graph_plot

plot(grps_graph_plot)

```

It can be seen that the group "Corona Infos und Fakten" is isolated (no shared contributors with the other groups). The groups "Corona Rebellen Chat" and "Corona Virus Informationen" share around 30 contributors. This is still only a small fraction of all contributors. We conclude that most users are only actively posting links from traditional or alternative media domains in one of the groups.


## Testing difference in the forward-ratio in groups

The table below shows the number of occurrences and total forwards of alternative and traditional media links posted in the four groups by category. "Occurrences in groups" is the total number of times a link from one of the categories was posted in one of the groups (either directly or by forward). "Total forwards" is the subset of those links which got there through a forward from any Telegram channel. 
```{r occurance_groups_table, eval = TRUE, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE, tidy = TRUE, results = 'asis'}
# add the ratio of forwarded links to original posts
links_cat_agg <- links_cat[,.(occurrences = .N, forwards = sum(forwarded)),
                           by=.(category, link_short)]

links_cat_agg_table <- links_cat[,.(occurrences_in_group = .N, total_forwarded = sum(forwarded)),
                           by=.(category)]

kable(links_cat_agg_table)
```
As stated in the main body of the analysis, it can be seen that occurrence of the links is similar for both category, but that much more of the links from alternative media got there by being forwarded while more of the traditional media links were posted directly into the groups. This analysis explores, whether this difference in the forward-ratio is significant.

For each of the domains in the sample, the forward-ratio is calculated as follows:

$$ forward\_ratio = \frac{total\_forwarded}{occurrences\_in\_groups} $$
We now want to test the hypothesis that the forward-ratio for alternative media links is higher than the forward-ratio of traditional media links.


```{r forward_ratio_groups, eval = TRUE, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE, tidy = TRUE}
# add the ratio of forwarded links to original posts
links_cat_agg$ratio_forwarded <- links_cat_agg$forwards/links_cat_agg$occurrences
```

```{r forward_ratio_groups_plot, eval = TRUE, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE, tidy = TRUE, fig.align = "center", fig.asp = 0.5, out.width="100%"}

# plot the distribution of the forward-ratios for alternative and traditional media links and add the means
mu <- links_cat_agg[, .(mu=mean(ratio_forwarded)), by = category]
p <- links_cat_agg %>% 
  ggplot(aes(x=ratio_forwarded, color = category)) +
  geom_density() +
  geom_vline(data=mu, aes(xintercept=mu, color=category), linetype="dashed") +
  labs(title = "Distribution of the mean forward-ratio by link-category")
p

```

The distribution of the forward-ratio by category suggests that the forward-ratio for alternative domains is higher.

The Null hypothesis that that the forward-ratio of alternative media links is equal or lower than that of traditional media links is tested against the alternative that the forward-ratio of alternative media links is higher with a permutation test.
```{r permutation_groups_plot, eval = TRUE, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE, tidy = TRUE, fig.align = "center", fig.asp = 0.5, out.width="100%"}

permutation_test_naiv <- perm_test_links(links_cat_agg)

permutation_test_naiv_plot <- permutation_test_naiv[["plot"]]
permutation_test_naiv_plot
```
The p_value is significantly below 0.05, thus the Null hypothesis that the forward-ratio for traditional media links is not higher than that of traditional media links is rejected. This suggests that links from alternative media sources are more likely to arrive at the groups by forward from other Telegram channels, than traditional media links. Note that the conducted test is a one-sided test.


## List of links and their categories

```{r media_list, eval = TRUE, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE, tidy = TRUE, results = 'asis'}
kable(media)
```

